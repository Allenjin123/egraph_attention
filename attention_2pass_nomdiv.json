{
  "nodes": {
    "function-1-CreateTensor": {
      "op": "CreateTensor",
      "children": [
        "primitive-i64-64",
        "primitive-i64-1024",
        "primitive-String-1"
      ],
      "eclass": "Tensor-1",
      "cost": 0.0,
      "subsumed": false
    },
    "function-0-R_max_m0": {
      "op": "R_max_m0",
      "children": [
        "function-0-R_add_e"
      ],
      "eclass": "Tensor-13",
      "cost": 10.0,
      "subsumed": false
    },
    "primitive-String-1": {
      "op": "\"K\"",
      "children": [],
      "eclass": "String-1",
      "cost": 1.0,
      "subsumed": false
    },
    "function-0-CreateTensor": {
      "op": "CreateTensor",
      "children": [
        "primitive-i64-64",
        "primitive-i64-1024",
        "primitive-String-0"
      ],
      "eclass": "Tensor-0",
      "cost": 0.0,
      "subsumed": false
    },
    "function-0-M_mul_fmp": {
      "op": "M_mul_fmp",
      "children": [
        "function-0-M_div_m1m0p",
        "function-2-CreateTensor"
      ],
      "eclass": "Tensor-10",
      "cost": 1.0,
      "subsumed": false
    },
    "function-0-M_exp_m1m0p": {
      "op": "M_exp_m1m0p",
      "children": [
        "function-0-M_sub_m1m0p"
      ],
      "eclass": "Tensor-7",
      "cost": 10.0,
      "subsumed": false
    },
    "function-0-T_split_m_m1m0": {
      "op": "T_split_m_m1m0",
      "children": [
        "function-1-CreateTensor",
        "primitive-i64-4"
      ],
      "eclass": "Tensor-12",
      "cost": 100.0,
      "subsumed": false
    },
    "function-2-CreateTensor": {
      "op": "CreateTensor",
      "children": [
        "primitive-i64-64",
        "primitive-i64-1024",
        "primitive-String-2"
      ],
      "eclass": "Tensor-2",
      "cost": 0.0,
      "subsumed": false
    },
    "primitive-i64-64": {
      "op": "64",
      "children": [],
      "eclass": "i64-64",
      "cost": 1.0,
      "subsumed": false
    },
    "primitive-i64-1024": {
      "op": "1024",
      "children": [],
      "eclass": "i64-1024",
      "cost": 1.0,
      "subsumed": false
    },
    "function-0-R_add_m1": {
      "op": "R_add_m1",
      "children": [
        "function-0-R_add_m0"
      ],
      "eclass": "Tensor-8",
      "cost": 100.0,
      "subsumed": false
    },
    "primitive-String-0": {
      "op": "\"Q\"",
      "children": [],
      "eclass": "String-0",
      "cost": 1.0,
      "subsumed": false
    },
    "function-1-R_add_m0": {
      "op": "R_add_m0",
      "children": [
        "function-0-M_mul_fmp"
      ],
      "eclass": "Tensor-15",
      "cost": 10.0,
      "subsumed": false
    },
    "function-0-R_add_m0": {
      "op": "R_add_m0",
      "children": [
        "function-0-M_exp_m1m0p"
      ],
      "eclass": "Tensor-14",
      "cost": 10.0,
      "subsumed": false
    },
    "function-0-R_add_e": {
      "op": "R_add_e",
      "children": [
        "function-0-M_mul_em1m0p"
      ],
      "eclass": "Tensor-4",
      "cost": 1.0,
      "subsumed": false
    },
    "function-1-R_add_m1": {
      "op": "R_add_m1",
      "children": [
        "function-1-R_add_m0"
      ],
      "eclass": "Tensor-11",
      "cost": 100.0,
      "subsumed": false
    },
    "primitive-i64-4": {
      "op": "4",
      "children": [],
      "eclass": "i64-4",
      "cost": 1.0,
      "subsumed": false
    },
    "function-0-M_sub_m1m0p": {
      "op": "M_sub_m1m0p",
      "children": [
        "function-0-R_add_e",
        "function-0-R_max_m0"
      ],
      "eclass": "Tensor-6",
      "cost": 10.0,
      "subsumed": false
    },
    "function-0-M_div_m1m0p": {
      "op": "M_div_m1m0p",
      "children": [
        "function-0-M_exp_m1m0p",
        "function-0-R_add_m1"
      ],
      "eclass": "Tensor-9",
      "cost": 50.0,
      "subsumed": false
    },
    "primitive-String-2": {
      "op": "\"V\"",
      "children": [],
      "eclass": "String-2",
      "cost": 1.0,
      "subsumed": false
    },
    "function-0-M_mul_em1m0p": {
      "op": "M_mul_em1m0p",
      "children": [
        "function-0-CreateTensor",
        "function-0-T_split_m_m1m0"
      ],
      "eclass": "Tensor-3",
      "cost": 10.0,
      "subsumed": false
    }
  },
  "root_eclasses": [
    "Tensor-11"
  ],
  "class_data": {
    "i64-64": {
      "type": "i64"
    },
    "i64-1024": {
      "type": "i64"
    },
    "String-0": {
      "type": "String"
    },
    "String-1": {
      "type": "String"
    },
    "String-2": {
      "type": "String"
    },
    "i64-4": {
      "type": "i64"
    },
    "Tensor-12": {
      "type": "Tensor"
    },
    "Tensor-3": {
      "type": "Tensor",
      "let": "QK_temp"
    },
    "Tensor-10": {
      "type": "Tensor",
      "let": "AV_temp"
    },
    "Tensor-9": {
      "type": "Tensor",
      "let": "A"
    },
    "Tensor-6": {
      "type": "Tensor",
      "let": "QK_shifted"
    },
    "Tensor-4": {
      "type": "Tensor",
      "let": "QK"
    },
    "Tensor-13": {
      "type": "Tensor"
    },
    "Tensor-7": {
      "type": "Tensor",
      "let": "SN"
    },
    "Tensor-8": {
      "type": "Tensor",
      "let": "SD"
    },
    "Tensor-14": {
      "type": "Tensor"
    },
    "Tensor-11": {
      "type": "Tensor",
      "let": "AV"
    },
    "Tensor-15": {
      "type": "Tensor"
    },
    "Tensor-0": {
      "type": "Tensor",
      "let": "Q"
    },
    "Tensor-1": {
      "type": "Tensor",
      "let": "K"
    },
    "Tensor-2": {
      "type": "Tensor",
      "let": "V"
    }
  },
  "extraction_info": {
    "num_eclasses": 21,
    "num_nodes": 21,
    "selected_ops": [
      "M_sub_m1m0p",
      "M_exp_m1m0p",
      "R_add_m1",
      "CreateTensor",
      "M_mul_em1m0p",
      "M_mul_fmp",
      "M_div_m1m0p",
      "R_add_m0",
      "T_split_m_m1m0",
      "R_max_m0",
      "R_add_e"
    ]
  },
  "analysis": {
    "num_eclasses": 15,
    "num_nodes": 15,
    "total_cost": 30,
    "op_counts": {
      "CreateTensor": 3,
      "R_add_m1": 2,
      "R_max_m0": 1,
      "R_add_m0": 2,
      "R_add_e": 1,
      "M_mul_fmp": 1,
      "M_sub_m1m0p": 1,
      "M_div_m1m0p": 1,
      "M_exp_m1m0p": 1,
      "T_split_m_m1m0": 1,
      "M_mul_em1m0p": 1
    },
    "algorithm_type": "2-pass (tiled)"
  }
}